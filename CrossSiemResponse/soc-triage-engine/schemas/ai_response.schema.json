{
  "_comment": {
    "purpose": "This is what Ai can say and how to say it, this is meant verifying instructions & prevent ai halluciation as well as bad inputs",
    "design_philosophy": [
      "AI explains evidence",
      "All outputs must be structured and reviewable",
      "Uncertainty must be explicit, not hidden",
      "No direct execution or auto-remediation instructions"
    ],
    "core_sections": {
      "observations": "What is factually observed based on verified evidence.",
      "assessment": "What the incident most likely represents, with uncertainty.",
      "mitre_mapping": "MITRE ATT&CK techniques inferred from behavior, with confidence.",
      "recommendations": "Next steps for analysts (queries, checks, containment ideas).",
      "confidence": "Overall confidence score expressing likelihood of malicious activity.",
      "assumptions": "What the AI had to assume due to missing or incomplete data.",
      "missing_data": "Information that would increase confidence if available."
    },
    "important_note": "This output is advisory only. Final decisions always remain with a human analyst or policy gate."
  },

  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "AI Triage Response Schema v1",
  "description": "Strict schema for AI-generated SOC triage output",
  "type": "object",

  "required": [
    "observations",
    "assessment",
    "mitre_mapping",
    "recommendations",
    "confidence",
    "assumptions",
    "missing_data"
  ],

  "properties": {
    "observations": {
      "type": "array",
      "description": "Factual statements derived from verified enrichment data",
      "items": {
        "type": "string"
      },
      "minItems": 1
    },

    "assessment": {
      "type": "string",
      "description": "High-level interpretation of what the incident likely represents, including uncertainty"
    },

    "mitre_mapping": {
      "type": "array",
      "description": "MITRE ATT&CK techniques that may apply to this incident",
      "items": {
        "type": "object",
        "required": ["tactic", "technique", "confidence", "evidence"],
        "properties": {
          "tactic": {
            "type": "string",
            "description": "MITRE ATT&CK tactic name (e.g., Credential Access)"
          },
          "technique": {
            "type": "string",
            "description": "MITRE ATT&CK technique ID and name (e.g., T1078 - Valid Accounts)"
          },
          "confidence": {
            "type": "number",
            "minimum": 0,
            "maximum": 1,
            "description": "Confidence that this technique applies"
          },
          "evidence": {
            "type": "array",
            "items": { "type": "string" },
            "description": "Evidence supporting this MITRE mapping"
          }
        }
      }
    },

    "recommendations": {
      "type": "array",
      "description": "Actionable next steps for analysts",
      "items": {
        "type": "object",
        "required": ["type", "description"],
        "properties": {
          "type": {
            "type": "string",
            "enum": ["query", "verification", "containment", "monitoring"],
            "description": "Category of recommendation"
          },
          "description": {
            "type": "string",
            "description": "Clear, human-readable recommendation"
          }
        }
      }
    },

    "confidence": {
      "type": "number",
      "minimum": 0,
      "maximum": 100,
      "description": "Overall confidence score indicating likelihood of malicious activity"
    },

    "assumptions": {
      "type": "array",
      "description": "Assumptions made due to incomplete data",
      "items": {
        "type": "string"
      }
    },

    "missing_data": {
      "type": "array",
      "description": "Data points that would improve confidence if available",
      "items": {
        "type": "string"
      }
    }
  }
}
